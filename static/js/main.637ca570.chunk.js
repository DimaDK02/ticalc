(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{38:function(e,t,n){e.exports=n.p+"static/media/logo.4d10b61e.png"},41:function(e,t,n){e.exports=n(93)},69:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(24),i=n.n(o),c=n(39),l=n(16),u=n.n(l),s=n(18),d=n.n(s),h=n(3),p=n.n(h),m=n(4),v=n(5),f=n(7),E=n(6),k=n(8),y=n(13),w=n(1),g=(n(29),n(19)),S=n(26),C=n(25),b=n.n(C),A=n(35),P=n.n(A);var x=function(){return Object(w.platform)()===w.IOS?r.a.createElement(P.a,null):r.a.createElement(b.a,null)};function R(e){var t=e.panelHeaderProps,n=e.onBackButtonClick,a=e.text;return r.a.createElement(w.PanelHeader,Object.assign({},t,{left:r.a.createElement(w.HeaderButton,{onClick:n},r.a.createElement(x,null))}),a)}function I(e,t){var n=t.shouldLowerCase,a=t.maxLength,r=e.trimLeft();return n&&(r=r.toLowerCase()),a&&(r=r.slice(0,a)),r}R.defaultProps={panelHeaderProps:{}};var O=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).notFoundComponent=r.a.createElement(w.Div,{style:{textAlign:"center"}},r.a.createElement("p",null,"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e")),n.state={searchText:""},n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"onSearchChange",value:function(e){var t=I(e,{shouldLowerCase:!1,maxLength:35});this.setState({searchText:t})}},{key:"render",value:function(){var e=this,t=this.state.searchText,n=this.props,a=n.id,o=n.backClickHandler,i=n.header,c=n.onSelect;return r.a.createElement(w.Panel,{id:a},r.a.createElement(R,{onBackButtonClick:function(){return o()},text:i,panelHeaderProps:{noShadow:!0}}),r.a.createElement(w.Search,{onChange:function(t){return e.onSearchChange(t)},value:t}),this.items.length>0&&r.a.createElement(w.List,null,this.items.map(function(e){return r.a.createElement(w.Cell,{key:e.id,onClick:function(){o(),c(e)}},e.value)})),!this.items.length&&this.notFoundComponent)}},{key:"items",get:function(){var e=this.state.searchText,t=this.props.items,n=I(e,{shouldLowerCase:!0});return t.filter(function(e){return I(e.value,{shouldLowerCase:!0}).includes(n)})}}]),t}(r.a.Component);n(69);function T(e){var t=e.text,n=e.value,a=e.additionalClassesAsStr;return r.a.createElement(M,{text:t,value:"".concat(n," \u0440\u0443\u0431"),additionalClassesAsStr:"money ".concat(a||"")})}function j(e){var t=e.text,n=e.value;return r.a.createElement(T,{text:t,value:n,additionalClassesAsStr:"summary"})}function M(e){var t=e.text,n=e.value,a=e.onClick,o=e.additionalClassesAsStr;return r.a.createElement(w.Cell,{onClick:a&&function(){return a()}},r.a.createElement("div",{className:"indicator ".concat(o||"")},r.a.createElement("div",{className:"text-wrapper"},r.a.createElement("span",null,t)),r.a.createElement("div",{className:"value-wrapper"},r.a.createElement("span",{className:"value"},n))))}T.defaultProps={additionalClassesAsStr:""},M.defaultProps={onClick:function(){},additionalClassesAsStr:""};var V=n(17),N=n(20),H=n.n(N);function _(e){return Number.parseInt(e,10)||0}function L(e){return"---"===e?"":e}function B(e){var t={works:[],materials:[]};return e.forEach(function(e){var n=function(e){return{name:L(e.MATERIAL_NAME),price:_(e.MATERIAL_PRICE)}}(e);n.name&&t.materials.push(n);var a=function(e){return{name:L(e.SERVICE_NAME),price:_(e.SERVICE_PRICE)}}(e);a.name&&t.works.push(a)}),t}function G(e,t){return e.type===t}function q(e){return new Promise(function(t,n){u.a.subscribe(function(a){var r=a.detail;G(r,"".concat(e,"Result"))?t(r.data):G(r,"".concat(e,"Failed"))&&n(r.data)}),u.a.send(e,{})})}function W(e){return Object.entries(e).map(function(e){var t=Object(V.a)(e,2),n=t[0],a=t[1];return{id:parseInt(n,10),value:a}})}function F(e,t){var n=new URLSearchParams;return Object.entries(t).forEach(function(e){var t=Object(V.a)(e,2),a=t[0],r=t[1];n.append(a,r)}),H.a.post(e,n)}function U(e){return new Promise(function(t){setTimeout(t,1e3*e)})}var D=Boolean(parseInt("0",10)),z='\n    <noscript>\n        <div><img src="https://mc.yandex.ru/watch/50376901" style="position:absolute; left:-9999px;" alt="" /></div>\n    </noscript>\n';function J(e){if(D)try{window.yaCounter50376901.reachGoal(e)}catch(t){console.warn("Tried to reach goal ".concat(e,", but Yandex.Metrika is blocked or removed"))}}var K={67223:"1.6\u043b., \u0431\u0435\u043d\u0437\u0438\u043d, 117 \u043b.\u0441., CVT",67271:"1.6\u043b., \u0442\u0443\u0440\u0431\u043e, \u0431\u0435\u043d\u0437\u0438\u043d, 200 \u043b.\u0441., 4\u04452 \u041c\u041a\u041f\u041f",67272:"1.6\u043b., \u0431\u0435\u043d\u0437\u0438\u043d, 117 \u043b.\u0441., \u041c\u041a\u041f\u041f",67273:"1.6\u043b., \u0442\u0443\u0440\u0431\u043e, \u0431\u0435\u043d\u0437\u0438\u043d, 200 \u043b.\u0441., 4\u04454 CVT"},Y=[{SERVICE_NAME:"\u0417\u0430\u043c\u0435\u043d\u0430 \u043c\u043e\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u043c\u0430\u0441\u043b\u0430 (\u0431\u0435\u0437 \u0441\u043d\u044f\u0442\u0438\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u0414\u0412\u0421)",SERVICE_PRICE:"600",MATERIAL_NAME:"\u041c\u043e\u0442\u043e\u0440\u043d\u043e\u0435 \u043c\u0430\u0441\u043b\u043e 5\u043b.",MATERIAL_PRICE:"2250"},{SERVICE_NAME:"\u0417\u0430\u043c\u0435\u043d\u0430 \u043c\u0430\u0441\u043b\u044f\u043d\u043e\u0433\u043e \u0444\u0438\u043b\u044c\u0442\u0440\u0430 (\u0431\u0435\u0437 \u0441\u043d\u044f\u0442\u0438\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u0414\u0412\u0421)",SERVICE_PRICE:"---",MATERIAL_NAME:"\u041c\u0430\u0441\u043b\u044f\u043d\u044b\u0439 \u0444\u0438\u043b\u044c\u0442\u0440",MATERIAL_PRICE:"450"},{SERVICE_NAME:"\u0417\u0430\u043c\u0435\u043d\u0430 \u043f\u0440\u043e\u043a\u043b\u0430\u0434\u043a\u0438 \u0441\u043b\u0438\u0432\u043d\u043e\u0439 \u043f\u0440\u043e\u0431\u043a\u0438",SERVICE_PRICE:"---",MATERIAL_NAME:"\u041f\u0440\u043e\u043a\u043b\u0430\u0434\u043a\u0430 \u0441\u043b\u0438\u0432\u043d\u043e\u0439 \u043f\u0440\u043e\u0431\u043a\u0438",MATERIAL_PRICE:"50"},{SERVICE_NAME:"\u0417\u0430\u043c\u0435\u043d\u0430 \u0432\u043e\u0437\u0434\u0443\u0448\u043d\u043e\u0433\u043e \u0444\u0438\u043b\u044c\u0442\u0440\u0430",SERVICE_PRICE:"300",MATERIAL_NAME:"\u0412\u043e\u0437\u0434\u0443\u0448\u043d\u044b\u0439 \u0444\u0438\u043b\u044c\u0442\u0440",MATERIAL_PRICE:"450"},{SERVICE_NAME:"\u0417\u0430\u043c\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u0432\u0435\u043d\u0442\u0438\u043b\u044f\u0446\u0438\u0438 \u0441\u0430\u043b\u043e\u043d\u0430",SERVICE_PRICE:"400",MATERIAL_NAME:"\u0424\u0438\u043b\u044c\u0442\u0440 \u0432\u0435\u043d\u0442\u0438\u043b\u044f\u0446\u0438\u0438 \u0441\u0430\u043b\u043e\u043d\u0430",MATERIAL_PRICE:"400"},{SERVICE_NAME:"C\u043c\u0430\u0437\u043a\u0430 \u043f\u0435\u0442\u0435\u043b\u044c, \u0437\u0430\u043c\u043a\u043e\u0432",SERVICE_PRICE:"100",MATERIAL_NAME:"---",MATERIAL_PRICE:"---"},{SERVICE_NAME:"\u0414\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0430 (\u0432\u0441\u0435\u0445 \u0441\u0438\u0441\u0442\u0435\u043c, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u0443\u044e, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u0440\u043e\u0441\u0441\u0435\u043b\u044c\u043d\u043e\u0439 \u0437\u0430\u0441\u043b\u043e\u043d\u043a\u0438)",SERVICE_PRICE:"1490",MATERIAL_NAME:"---",MATERIAL_PRICE:"---"}],Q=[{id:43,value:"Almera Classic (2006-2013)"},{id:44,value:"Almera New (\u0441 2012)"},{id:45,value:"Juke (\u0441 2011)"},{id:46,value:"Micra (\u0441 2002)"},{id:47,value:"Murano (2008-2015)"},{id:48,value:"Murano (\u0441 2015)"},{id:49,value:"Navara (\u0441 2010)"},{id:50,value:"Note (2006-2014)"},{id:51,value:"Pathfinder (2010-2013)"},{id:52,value:"Pathfinder (\u0441 2013)"},{id:53,value:"Qashqai (2006-2013)"},{id:54,value:"Qashqai (\u0441 2013)"},{id:55,value:"Teana (2008-2013)"},{id:56,value:"Teana (\u0441 2013)"},{id:57,value:"Terrano (\u0441 2013)"},{id:58,value:"Tiida (2004-2015)"},{id:60,value:"X-Trail (2010-2014)"},{id:61,value:"X-Trail (\u0441 2014)"},{id:62,value:"Sentra (\u0441 2014)"}],X=[{id:1,value:"15000 \u0438\u043b\u0438 1 \u0433\u043e\u0434"},{id:2,value:"30000 \u0438\u043b\u0438 2 \u0433\u043e\u0434\u0430"},{id:3,value:"45000 \u0438\u043b\u0438 3 \u0433\u043e\u0434\u0430"},{id:4,value:"60000 \u0438\u043b\u0438 4 \u0433\u043e\u0434\u0430"},{id:5,value:"75000 \u0438\u043b\u0438 5 \u043b\u0435\u0442"},{id:6,value:"90000 \u0438\u043b\u0438 6 \u043b\u0435\u0442"},{id:7,value:"105000 \u0438\u043b\u0438 7 \u043b\u0435\u0442"},{id:8,value:"120000 \u0438\u043b\u0438 8 \u043b\u0435\u0442"},{id:9,value:"135000 \u0438\u043b\u0438 9 \u043b\u0435\u0442"},{id:10,value:"150000 \u0438\u043b\u0438 10 \u043b\u0435\u0442"}],Z=n(36),$=n.n(Z);var ee,te=function(e){var t=[{title:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437",action:e.onRetry},{title:"\u041e\u0442\u043c\u0435\u043d\u0430",action:e.onCancel,style:"cancel"}];return r.a.createElement(w.Alert,{actions:t,actionsLayout:"vertical"},r.a.createElement($.a,{style:{color:"red",margin:"0 auto"}}),r.a.createElement("p",null,"\u0423\u043f\u0441, \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u0441\u0435\u0442\u044c\u044e. \u0421\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u0412\u044b \u043d\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443."),r.a.createElement("span",null,"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u0441\u044c \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0435\u0449\u0435 \u0440\u0430\u0437"))},ne={calculationResults:{status:"notSelected",works:[],materials:[]},popout:null};function ae(){window.history.back()}function re(e){return{id:e.id,text:e.value}}function oe(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(y.a)(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!D){e.next=4;break}return e.next=3,F("/ajax/model.php",{ID:t});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,U(.2);case 6:return e.abrupt("return",K);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ce(e,t,n){return le.apply(this,arguments)}function le(){return(le=Object(y.a)(p.a.mark(function e(t,n,a){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!D){e.next=4;break}return e.next=3,F("/ajax/to.php",{SECTION:t,TIME:a,AUTO:n});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,U(.5);case 6:return e.abrupt("return",Y);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}ne=Object(S.a)({},ne,{model:{id:0,text:ee="\u0412\u044b\u0431\u0440\u0430\u0442\u044c"},modification:{id:0,text:ee},oldness:{id:0,text:ee}});var ue=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).ctaText="\u041e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u0437\u0430\u044f\u0432\u043a\u0443, \u043d\u0430\u0448\u0438 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438 \u0441\u0432\u044f\u0436\u0443\u0442\u0441\u044f \u0441 \u0432\u0430\u043c\u0438 \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f Nissan",n.models=Q,n.modifications=[],n.oldnesses=X,n.headerText="\u0420\u0430\u0441\u0447\u0435\u0442 \u0422\u041e \u041d\u0438\u0441\u0441\u0430\u043d",n.onCtaClick=function(){var e=n.props.onCtaClick;J("open-send-request"),e()},n.ctaButton=r.a.createElement(w.Button,{align:"center",stretched:!0,size:"l",onClick:n.onCtaClick},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"),n.ctaComponent=r.a.createElement(w.Div,null,r.a.createElement("p",null,n.ctaText),n.ctaButton),n.getPanelHeader=function(){var e=n.props.onBack;return r.a.createElement(R,{text:n.headerText,onBackButtonClick:function(){return e()}})},n.onModelSelect=function(){var e=Object(y.a)(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.showSpinner(),J("selected-model"),n.resetModification(),e.prev=3,e.next=6,n.setModifications(t.id);case 6:n.setSelectValueAndTryToCalculateResults("model",t),n.removeAnyPopout(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),n.showNetworkErrorAlert(function(){return n.onModelSelect(t)});case 13:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),n.state=ne;var a=n.props.id;return ne.activePanel="".concat(a,"main"),window.onpopstate=function(){return n.onPopHistoryState()},window.history.replaceState({},"","#".concat(a,"/").concat(a,"main")),n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.state,t=e.calculationResults,n=e.model,a=e.modification,r=e.oldness;window.onpopstate=window.basePopHistoryStateHandler,window.calculationResults=t,window.input={model:n,modification:a,oldness:r}}},{key:"onPopHistoryState",value:function(){var e=window.location.hash;e.includes("home")?this.viewPopStateHandler():window.basePopHistoryStateHandler()}},{key:"getModelSelectIndicator",value:function(){var e=this,t=this.state.model;return r.a.createElement(M,{text:"\u041c\u043e\u0434\u0435\u043b\u044c \u0430\u0432\u0442\u043e",value:t.text,onClick:function(){return e.changePanelAndPushHistoryState("chooseModel")}})}},{key:"getModificationSelectIndicator",value:function(){var e=this,t=this.state.modification;return r.a.createElement(M,{text:"\u041c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f",value:t.text,onClick:function(){return e.changePanelAndPushHistoryState("chooseModification")}})}},{key:"getOldnessSelectIndicator",value:function(){var e=this,t=this.state.oldness;return r.a.createElement(M,{text:"\u041f\u0440\u043e\u0431\u0435\u0433 \u0438\u043b\u0438 \u0432\u0440\u0435\u043c\u044f",value:t.text,onClick:function(){return e.changePanelAndPushHistoryState("chooseOldness")}})}},{key:"getSelectIndicatorList",value:function(){return r.a.createElement(w.List,null,this.getModelSelectIndicator(),this.getModificationSelectIndicator(),this.getOldnessSelectIndicator())}},{key:"getCalculationSelectGroup",value:function(){return r.a.createElement(w.Group,null,r.a.createElement(w.Header,null,"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0432\u0430\u0448\u0435\u0433\u043e Nissan:"),this.getSelectIndicatorList())}},{key:"getResultWorkGroup",value:function(){var e=this.state.calculationResults;return r.a.createElement(w.Group,{title:"\u0420\u0430\u0431\u043e\u0442\u044b"},e.works.map(function(e){var t=e.name,n=e.price;return r.a.createElement(T,{text:t,value:n,key:t})}),r.a.createElement(j,{text:"\u0412\u0441\u0435\u0433\u043e \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u043c",value:this.getSummaryValue("works")}))}},{key:"getResultMaterialGroup",value:function(){var e=this.state.calculationResults;return r.a.createElement(w.Group,{title:"\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b"},e.materials.map(function(e){var t=e.name,n=e.price;return r.a.createElement(T,{text:t,value:n,key:t})}),r.a.createElement(j,{text:"\u0412\u0441\u0435\u0433\u043e \u043f\u043e \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u0430\u043c",value:this.getSummaryValue("materials")}))}},{key:"getSummaryValue",value:function(e){return this.state.calculationResults[e].reduce(function(e,t){return e+t.price},0)}},{key:"getResultSummaryGroup",value:function(){return r.a.createElement(w.Group,null,r.a.createElement(j,{text:"\u0418\u0442\u043e\u0433\u043e",value:this.getSummaryValue("works")+this.getSummaryValue("materials")}))}},{key:"getCalculationResultGroups",value:function(){return r.a.createElement("div",null,"ready"===this.resultsStatus&&r.a.createElement("div",null,this.getResultWorkGroup(),this.getResultMaterialGroup(),this.getResultSummaryGroup()))}},{key:"setSelectValueAndTryToCalculateResults",value:function(e,t){this.setState(Object(g.a)({},e,re(t)),this.tryToCalculateResults)}},{key:"getSelectedOldnessId",value:function(){return this.state.oldness.id}},{key:"getSelectedModificationId",value:function(){return this.state.modification.id}},{key:"getSelectedModelId",value:function(){return this.state.model.id}},{key:"getCalculationResults",value:function(){if("notSelected"===this.resultsStatus)return null;if("ready"===this.resultsStatus)return this.getCalculationResultGroups();throw new Error("invalid resultsStatus")}},{key:"setModifications",value:function(){var e=Object(y.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe(t);case 2:n=e.sent,this.modifications=W(n),this.setState({modification:re(this.modifications[0])});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setCalculationResults",value:function(e){this.removeAnyPopout(),this.setState({calculationResults:Object(S.a)({status:"ready"},e)})}},{key:"removeAnyPopout",value:function(){this.setState({popout:null})}},{key:"showSpinner",value:function(){this.setState({popout:r.a.createElement(w.ScreenSpinner,null)})}},{key:"allSelected",value:function(){return this.getSelectedModelId()&&this.getSelectedModificationId()&&this.getSelectedOldnessId()}},{key:"changePanel",value:function(e){this.setState({activePanel:e})}},{key:"calculateResults",value:function(){var e=Object(y.a)(p.a.mark(function e(){var t,n,a,r,o,i=this;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.model,a=t.modification,r=t.oldness,this.showSpinner(),e.prev=2,e.next=5,ce(n.id,a.id,r.id);case 5:o=B(o=e.sent),this.setCalculationResults(o),this.removeAnyPopout(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),this.showNetworkErrorAlert(function(){return i.calculateResults()});case 14:case"end":return e.stop()}},e,this,[[2,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"tryToCalculateResults",value:function(){var e=Object(y.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.allSelected()){e.next=3;break}return e.next=3,this.calculateResults();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resetModification",value:function(){this.setState({modification:{id:0,text:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}})}},{key:"changePanelAndPushHistoryState",value:function(e){var t;t="#home/".concat(e),window.history.pushState({},"",t),this.changePanel(e)}},{key:"viewPopStateHandler",value:function(){var e=window.location.hash,t=e.split("/",2)[1];this.changePanel(t)}},{key:"showNetworkErrorAlert",value:function(e){var t=this;this.setState({popout:r.a.createElement(te,{onRetry:function(){t.removeAnyPopout(),e()},onCancel:function(){return t.removeAnyPopout()}})})}},{key:"render",value:function(){var e=this,t=this.props.id,n=this.state,a=n.activePanel,o=n.popout,i="".concat(t,"main");return r.a.createElement(w.View,{id:t,activePanel:a,header:!0,popout:o},r.a.createElement(w.Panel,{id:i},this.getPanelHeader(),this.getCalculationSelectGroup(),this.getCalculationResults(),this.ctaComponent),r.a.createElement(O,{id:"chooseModel",backClickHandler:function(){return ae()},header:"\u041c\u043e\u0434\u0435\u043b\u044c",items:this.models,onSelect:this.onModelSelect}),r.a.createElement(O,{id:"chooseModification",backClickHandler:function(){return ae()},header:"\u041c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f",items:this.modifications,onSelect:function(t){J("selected-modification"),e.setSelectValueAndTryToCalculateResults("modification",t)}}),r.a.createElement(O,{id:"chooseOldness",backClickHandler:function(){return ae()},header:"\u041f\u0440\u043e\u0431\u0435\u0433 \u0438\u043b\u0438 \u0432\u0440\u0435\u043c\u044f",items:this.oldnesses,onSelect:function(t){J("selected-oldness"),e.setSelectValueAndTryToCalculateResults("oldness",t)}}))}},{key:"resultsStatus",get:function(){return this.state.calculationResults.status}}]),t}(r.a.Component),se=(n(89),n(40));function de(e){return new se.a("RU").input(e)}function he(e){return e.replace(/[^0-9]/g,"")}var pe=function(e){function t(e){var n;Object(m.a)(this,t);var a=(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).props.value;return a=a||"",n.state={value:a},n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.value;e.value!==t&&this.changeValue(t)}},{key:"onChange",value:function(e){var t=e.target.value;this.changeValue(t)}},{key:"changeValue",value:function(e){var t=this.props.onChange;if(function(e){return he(e).length<=11}(e)){var n=de(e);this.shouldChangeToFormatted(n,e)?(this.setState({value:n}),t(function(e){return"+".concat(he(e))}(e))):this.setState({value:e})}}},{key:"shouldChangeToFormatted",value:function(e,t){var n=this.state.value;return!(e.length===n.length&&t.length<e.length)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClick,a=t.className,o=t.placeholder,i=this.state.value;return r.a.createElement(w.Input,{type:"tel",placeholder:de(o),onChange:function(t){return e.onChange(t)},value:i,className:a,onClick:function(e){return n(e)}})}}]),t}(r.a.Component);pe.defaultProps={placeholder:"",value:"",className:""};var me=pe;function ve(e){var t=e.onChange,n=e.initialValue,o=Object(a.useState)(n||""),i=Object(V.a)(o,2),c=i[0],l=i[1],u=function(e){var n=e.replace(/[^A-Za-z\u0410-\u042fa-\u044f ]/g,"").replace(/ {2,}/," ").trimLeft();l(n),t(n)};return r.a.createElement("div",null,r.a.createElement("span",null,"\u0418\u043c\u044f"),r.a.createElement(w.Input,{type:"text",placeholder:"\u0418\u0432\u0430\u043d",onChange:function(e){return u(e.target.value)},value:c}))}ve.defaultProps={initialValue:""};var fe=ve,Ee={name:"",phone:"",phoneNotValid:!1,popout:null};function ke(e){return Boolean(function(e){return e.replace(/[^0-9]/g,"")}(e))}function ye(e){return"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"===e?"":e}function we(e,t){var n={model:ye(window.input.model.text),modification:ye(window.input.modification.text),oldness:ye(window.input.oldness.text)},a=n.model,r=n.modification,o=n.oldness,i={works:JSON.stringify(window.calculationResults.works),materials:JSON.stringify(window.calculationResults.materials)},c=i.works,l=i.materials;return H.a.get("request.php",{params:{model:a,modification:r,oldness:o,works:c,materials:l,name:e,phone:t}})}var ge=function(e){function t(e){var n;Object(m.a)(this,t);var a=(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).props.username;return n.state=Ee,n.state.name=a,n.requestedPhone=!1,n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"componentWillUnmount",value:function(){Ee=this.state}},{key:"onPhoneInputClick",value:function(){var e=Object(y.a)(p.a.mark(function e(){var t,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.requestedPhone){e.next=7;break}return this.requestedPhone=!0,e.next=4,q("VKWebAppGetPhoneNumber");case 4:t=e.sent,n=t.phone_number,this.setState({phone:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getForm",value:function(){var e=this,t=this.props.username;return r.a.createElement(w.Group,null,r.a.createElement(w.Div,null,r.a.createElement(w.Cell,null,r.a.createElement(fe,{onChange:function(t){return e.setState({name:t})},initialValue:t})),r.a.createElement(w.Cell,null,this.getPhoneComponent()),r.a.createElement(w.Cell,null,r.a.createElement(w.Button,{stretched:!0,size:"l",onClick:function(){return e.validateAndShowErrorsAndSendForm()}},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"))))}},{key:"getPhoneComponent",value:function(){var e=this,t=this.state,n=t.phone,a=t.phoneNotValid;return r.a.createElement("div",null,r.a.createElement("span",null,"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"),r.a.createElement(me,{placeholder:"+79211234567",value:n,onChange:function(t){return e.setState({phoneNotValid:!1}),e.setState({phone:t})},onClick:function(){return e.onPhoneInputClick()}}),a&&r.a.createElement("p",{className:"error-hint"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"))}},{key:"showSpinner",value:function(){this.setState({popout:r.a.createElement(w.ScreenSpinner,null)})}},{key:"removeAnyPopout",value:function(){this.setState({popout:null})}},{key:"showNetworkErrorAlert",value:function(e){var t=this;this.setState({popout:r.a.createElement(te,{onRetry:function(){t.removeAnyPopout(),e()},onCancel:function(){return t.removeAnyPopout()}})})}},{key:"doPostRequestTasks",value:function(){var e=this.props.onSentRequest;this.removeAnyPopout(),e()}},{key:"validateAndShowErrorsAndSendForm",value:function(){var e=Object(y.a)(p.a.mark(function e(){var t,n,a,r=this;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.name,!ke(a=t.phone)){e.next=15;break}return this.showSpinner(),e.prev=3,e.next=6,we(n,a);case 6:J("sent-manual-request"),this.doPostRequestTasks(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.showNetworkErrorAlert(function(){return r.validateAndShowErrorsAndSendForm()});case 13:e.next=16;break;case 15:this.setState({phoneNotValid:!0});case 16:case"end":return e.stop()}},e,this,[[3,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.id,n=e.onBack,a=this.state.popout,o="".concat(t,"main");return r.a.createElement(w.View,{id:t,activePanel:o,header:!0,popout:a},r.a.createElement(w.Panel,{id:o},r.a.createElement(R,{onBackButtonClick:n,text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"}),this.getForm()))}}]),t}(a.Component),Se=n(38),Ce=n.n(Se);n(90);var be=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).headerText="\u0420\u0430\u0441\u0447\u0435\u0442 \u0422\u041e \u041d\u0438\u0441\u0441\u0430\u043d \u0432 \u0421\u041f\u0431",n.onGoHome=function(){J("open-home"),(0,n.props.onGoHome)()};var a=n.props.id;return n.state={activePanel:"".concat(a,"main")},n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"getText",value:function(){var e,t=this.props.username;return e=t?"".concat(t,", \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435"):"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435",e+=" \u0441\u0432\u043e\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c Nissan \u0438 \u0443\u0437\u043d\u0430\u0439\u0442\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u043f\u0440\u043e\u0431\u0435\u0433\u0443 \u0438\u043b\u0438 \u0433\u043e\u0434\u0443",r.a.createElement("p",null,e)}},{key:"getGreeting",value:function(){var e=this.props.username,t=e?"".concat("\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435",", ").concat(e,"!"):"".concat("\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435","!");return r.a.createElement("p",null,t," \u0412\u044b \u0438\u0437 \u0421\u041f\u0431, \u0438 \u0443 \u0432\u0430\u0441 \u041d\u0438\u0441\u0441\u0430\u043d?")}},{key:"render",value:function(){var e=this.props.id,t=this.state.activePanel,n="".concat(e,"main");return r.a.createElement(w.View,{id:e,activePanel:t},r.a.createElement(w.Panel,{id:n},r.a.createElement(w.PanelHeader,null,this.headerText),r.a.createElement(w.Group,null,r.a.createElement(w.Div,null,r.a.createElement("div",{className:"centerring-wrapper"},r.a.createElement("img",{src:Ce.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u042f \u0421\u0435\u0440\u0432\u0438\u0441"})),r.a.createElement("div",null,this.getGreeting(),this.getText()),r.a.createElement(w.Button,{stretched:!0,size:"xl",onClick:this.onGoHome},"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0422\u041e")))))}}]),t}(r.a.Component),Ae=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).state={error:null},n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e}),d.a.captureException(e,{extra:t})}},{key:"render",value:function(){var e=this.state.error,t=this.props.children;return e?r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("p",null,"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a :("),r.a.createElement("p",null,"\u041d\u0430\u0448\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0443\u0436\u0435 \u0440\u0435\u0448\u0430\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0443")):t}}]),t}(r.a.Component),Pe=(n(91),function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).onGoToPublic=function(){return J("open-vk-public"),!0},n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.onBack,a="".concat(t,"main");return r.a.createElement(w.View,{id:t,activePanel:a},r.a.createElement(w.Panel,{id:a},r.a.createElement(R,{onBackButtonClick:function(){return n()},text:"\u0421\u043f\u0430\u0441\u0438\u0431\u043e"}),r.a.createElement(w.Group,null,r.a.createElement(w.Cell,{multiline:!0},r.a.createElement("div",null,"\u0421\u043f\u0430\u0441\u0438\u0431\u043e!"),r.a.createElement("div",null,"\u041d\u0430\u0448 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u0441\u0432\u044f\u0436\u0435\u0442\u0441\u044f \u0441 \u0412\u0430\u043c\u0438 \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f.")),r.a.createElement(w.Cell,{multiline:!0},r.a.createElement("span",{className:"thank-you-view__visit-group-text"},"\u0410 \u043f\u043e\u043a\u0430 \u0437\u0430\u0439\u0434\u0438\u0442\u0435 \u0432 \u043d\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e \u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435"),r.a.createElement("a",{href:"//vk.com/ya.service.nissan",className:"not-link",onClick:this.onGoToPublic,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(w.Button,{stretched:!0,size:"xl",style:{marginTop:"15px"}},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438"))))))}}]),t}(r.a.Component));function xe(){return Re.apply(this,arguments)}function Re(){return(Re=Object(y.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("VKWebAppGetUserInfo");case 2:return e.abrupt("return",e.sent.first_name);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ie(){window.history.back()}var Oe=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).state={activeView:"start",username:""},window.history.replaceState({},"","#start"),n.setGlobalHistoryStateHandler(),n}return Object(k.a)(t,e),Object(v.a)(t,[{key:"componentWillMount",value:function(){var e=Object(y.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.send("VKWebAppInit",{}),this.setOnPopStateEventHandler(),e.next=4,xe();case 4:t=e.sent,this.setUserName(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onPopHistoryState",value:function(){var e=function(e){return e.slice(1).split("/",1)[0]}(window.location.hash);this.changeView(e)}},{key:"setOnPopStateEventHandler",value:function(){var e=this;window.onpopstate=window.basePopHistoryStateHandler||function(){return e.onPopHistoryState()}}},{key:"setGlobalHistoryStateHandler",value:function(){var e=this;window.basePopHistoryStateHandler=function(){return e.onPopHistoryState()}}},{key:"setUserName",value:function(e){this.setState({username:e})}},{key:"changeView",value:function(e){this.setState({activeView:e})}},{key:"goHome",value:function(){this.changeViewAndPushHistoryItem("home")}},{key:"goToThankYouView",value:function(){this.changeViewAndPushHistoryItem("thank-you")}},{key:"goToSendRequest",value:function(){this.changeViewAndPushHistoryItem("sendRequest")}},{key:"changeViewAndPushHistoryItem",value:function(e){var t;t="#".concat(e),window.history.pushState({},"",t),this.changeView(e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.username,a=t.activeView;return r.a.createElement(Ae,null,r.a.createElement(w.Root,{activeView:a},r.a.createElement(ue,{id:"home",onCtaClick:function(){return e.goToSendRequest()},onBack:function(){return Ie()}}),r.a.createElement(ge,{id:"sendRequest",onBack:function(){return Ie()},onSentRequest:function(){return e.goToThankYouView()},username:n}),r.a.createElement(be,{id:"start",onGoHome:function(){return e.goHome()},username:n}),r.a.createElement(Pe,{id:"thank-you",onBack:function(){return Ie()}})))}}]),t}(a.Component);function Te(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));D&&(d.a.config("https://e1f809f399e2427898e1796a4a4d8c64@sentry.io/1280607").install(),function(e,t,n){(t[n]=t[n]||[]).push(function(){try{t.yaCounter50376901=new Ya.Metrika2({id:50376901,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})}catch(e){}});var a=e.getElementsByTagName("script")[0],r=e.createElement("script"),o=function(){a.parentNode.insertBefore(r,a)};r.type="text/javascript",r.async=!0,r.src="https://mc.yandex.ru/metrika/tag.js","[object Opera]"==t.opera?e.addEventListener("DOMContentLoaded",o,!1):o()}(document,window,"yandex_metrika_callbacks2"),document.body.innerHTML+=z);var Me,Ve=document.getElementById("root");l.send("VKWebAppInit",{}),Me=Oe,i.a.render(r.a.createElement(c.AppContainer,null,r.a.createElement(Me,null)),Ve),function(){if("serviceWorker"in navigator){if(new URL("/ticalc",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/ticalc","/service-worker.js");je?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Te(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Te(e)})}}()}},[[41,1,2]]]);
//# sourceMappingURL=main.637ca570.chunk.js.map